<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Personal Page</title>
    <!-- 기존 Bootstrap CSS -->
    <link
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <!-- 이하 공통 css link (반드시 유지!) -->
    <!-- 1. Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <!-- 2. Pretendard 폰트 적용 -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/pretendard/dist/web/static/pretendard.css"
    />
    <!-- 3. External CSS -->
    <link rel="stylesheet" href="styles/style.css" />
    <style>
      /* 기본 스타일 */
      body {
        font-family: Arial, sans-serif;
        margin: 20px;
      }
      .container {
        display: flex;
        align-items: center;
      }
      .profile {
        display: flex;
        align-items: center;
        margin-bottom: 20px;
        flex-direction: column;
      }
      .profile img {
        width: 150px;
        height: 150px;
        margin-right: 10px;
      }
      .profile-info {
        display: flex;
        flex-direction: column;
      }
      .sections {
        display: flex;
        flex-direction: column;
      }
      .section {
        margin-bottom: 10px;
      }
      .section button {
        margin-left: 10px;
      }
      .education-form {
        display: none;
        flex-direction: column;
        align-items: center;
        margin-top: 20px;
      }
      .education-form input {
        margin-bottom: 10px;
      }
      .education-list {
        margin-top: 20px;
      }
      .education-item {
        margin-bottom: 10px;
        display: flex;
        align-items: center;
      }
      .education-item span {
        flex-grow: 1;
      }
      .edit-btn,
      .delete-btn {
        margin-left: 10px;
      }
    </style>
  </head>

  <!-- 네비바 넣을 곳 -->
  <div id="navbar"></div>

  <body>
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.2/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <div class="container">
      <div class="profile">
        <img src="profile.jpg" alt="Profile Picture" width="100" height="100" />
        <div class="profile-info">
          <span>1234</span>
          <span>ktkim@elicer.com</span>
          <span>설명이 아직 없습니다. 추가해 주세요.</span>
        </div>
      </div>
      <div class="sections">
        <div class="section">
          <span>학력</span>
          <div class="education-list" id="educationList"></div>
          <div class="education-form" id="educationForm">
            <h3>학력 추가</h3>
            <input type="text" id="schoolName" placeholder="학교 이름" />
            <input type="text" id="major" placeholder="전공" />
            <div>
              <input type="radio" name="degree" value="재학중" /> 재학중
              <input type="radio" name="degree" value="학사졸업" /> 학사졸업
              <input type="radio" name="degree" value="석사졸업" /> 석사졸업
              <input type="radio" name="degree" value="박사졸업" /> 박사졸업
            </div>
            <button id="confirmBtn">확인</button>
            <button id="cancelBtn">취소</button>
          </div>
          <button id="addEducationBtn" class="btn btn-primary">+</button>
        </div>
        <div class="section">
          <span>수상이력</span>
          <button>+</button>
        </div>
        <div class="section">
          <span>프로젝트</span>
          <button>+</button>
        </div>
        <div class="section">
          <span>자격증</span>
          <button>+</button>
        </div>
      </div>
    </div>

    <script>
      //   fetch("components/navbar.js")
      //     .then((response) => {
      //       if (!response.ok) {
      //         throw new Error(
      //           "Network response was not ok: " + response.statusText
      //         );
      //       }
      //       return response.text();
      //     })
      //     .then((data) => {
      //       document.getElementById("navbar").innerText = data;
      //     })
      //     .catch((error) => {
      //       console.error("There was a problem with the fetch operation:", error);
      //     });
      //   let educationList = [];
      //   let editingIndex = -1;

      document
        .getElementById("addEducationBtn")
        .addEventListener("click", function () {
          editingIndex = -1;
          clearForm();
          const x = document.getElementById("educationForm");
          if (x.style.display === "none") {
            x.style.display = "flex";
          } else {
            x.style.display = "none";
          }
        });

      document
        .getElementById("cancelBtn")
        .addEventListener("click", function () {
          clearForm();
          document.getElementById("educationForm").style.display = "none";
        });

      document
        .getElementById("confirmBtn")
        .addEventListener("click", function () {
          const schoolName = document.getElementById("schoolName").value;
          const major = document.getElementById("major").value;
          const degreeElement = document.querySelector(
            'input[name="degree"]:checked'
          );
          const degree = degreeElement ? degreeElement.value : "";

          if (schoolName && major && degree) {
            if (editingIndex === -1) {
              // 새로운 항목 추가
              educationList.push({
                schoolName: schoolName,
                major: major,
                degree: degree,
              });
            } else {
              // 기존 항목 편집
              educationList[editingIndex] = {
                schoolName: schoolName,
                major: major,
                degree: degree,
              };
              editingIndex = -1;
            }

            updateEducationList();
            clearForm();
            document.getElementById("educationForm").style.display = "none";
          } else {
            alert("모든 필드를 입력해 주세요.");
          }
        });

      function updateEducationList() {
        const educationListDiv = document.getElementById("educationList");
        educationListDiv.innerHTML = "";

        educationList.forEach(function (item, index) {
          const educationItemDiv = document.createElement("div");
          educationItemDiv.className = "education-item";

          const educationText = document.createElement("span");
          educationText.innerText =
            item.schoolName + "\n" + item.major + " (" + item.degree + ")";
          educationItemDiv.appendChild(educationText);

          const editBtn = document.createElement("button");
          editBtn.className = "edit-btn";
          editBtn.innerText = "편집";
          editBtn.addEventListener("click", function () {
            editEducation(index);
          });
          educationItemDiv.appendChild(editBtn);

          const deleteBtn = document.createElement("button");
          deleteBtn.className = "delete-btn";
          deleteBtn.innerText = "삭제";
          deleteBtn.addEventListener("click", function () {
            deleteEducation(index);
          });
          educationItemDiv.appendChild(deleteBtn);

          educationListDiv.appendChild(educationItemDiv);
        });
      }

      function editEducation(index) {
        editingIndex = index;
        const item = educationList[index];
        document.getElementById("schoolName").value = item.schoolName;
        document.getElementById("major").value = item.major;
        const degrees = document.getElementsByName("degree");
        for (let i = 0; i < degrees.length; i++) {
          degrees[i].checked = degrees[i].value === item.degree;
        }
        document.getElementById("educationForm").style.display = "flex";
      }

      function deleteEducation(index) {
        educationList.splice(index, 1);
        updateEducationList();
      }

      function clearForm() {
        document.getElementById("schoolName").value = "";
        document.getElementById("major").value = "";
        const degrees = document.getElementsByName("degree");
        for (let i = 0; i < degrees.length; i++) {
          degrees[i].checked = false;
        }
      }
    </script>
    <script src="./scripts/navbar.js"></script>
  </body>
</html>
